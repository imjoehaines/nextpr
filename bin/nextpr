#!/usr/bin/env ruby

require_relative "../lib/nextpr"

token = ENV.fetch("NEXTPR_TOKEN")

case ARGV.length
when 1
  owner, repository = ARGV[0].split("/", 2)
when 2
  owner = ARGV[0]
  repository = ARGV[1]
else
  raise "Invalid arguments: #{ARGV}"
end

puts "nextpr v#{NextPr::VERSION}"
puts "Querying #{owner}/#{repository}"

nextpr = NextPr.find(token, owner, repository)

puts "The next PR for #{owner}/#{repository} is: #{nextpr}"
